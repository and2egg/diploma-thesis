

\section{Definition of simulation scenarios} \label{sec:definition_of_simulation_scenarios}

In this section the simulation scenarios and settings are described to get a complete picture of the simulated cloud environment. 

The simulation scenarios can be divided into two parts which are day ahead and real time simulations based on day ahead and real time energy prices, respectively. For each type of simulation different locations and energy markets have been chosen. The basic scenario types are oulined below. 


\subsection{Day ahead simulation scenario}

The simulation scenario for day ahead energy prices is comprised of data centers located in Europe and the USA. A map showing five data centers as a basis for day ahead simulations is outlined in Figure \ref{fig:usa_europe_map}. 

\begin{figure}[htbp]
	\centering
		\includegraphics[width=0.7\textwidth]{figures/evaluation_and_results/usa_europe_map.png}
	\caption{Map of data center locations for day ahead price simulations}
	\label{fig:usa_europe_map}
\end{figure}

The locations have been chosen such that a diverse set of data from different energy markets is available. In addition time zone effects should be modeled by placing data centers sufficiently far from each other such that daily variation of energy prices in different time zones can be utilized. 

A list of day ahead energy markets and corresponding locations is shown in Table \ref{tab:list_of_day_ahead_markets}. 


\begin{table}[htbp]
\centering
\begin{tabular}{ll}
\toprule
 Energy market & Location \\
\midrule
	Nord Pool Spot &  Hamina, Finland \\
	Belpex &  St. Ghislain, Belgium \\
	EPEXSpot &  Potsdam, Germany \\
	ISO New England &  Portland, Maine \\
	ISO New England &  Boston, Massachussetts \\
\bottomrule
\end{tabular}
\caption{List of day ahead energy markets and locations}
\label{tab:list_of_day_ahead_markets}
\end{table}




\subsection{Real time simulation scenario}

For the real time simulation scenario data centers have been chosen exclusively from location within the US. Thus energy prices are more localized and performance of simulations should be evaluated for datasets with similar characteristics in contrast to day ahead simulations. 

A map showing data centers for all real time markets and locations is depicted in Figure \ref{fig:usa_map}. 

\begin{figure}[htbp]
	\centering
		\includegraphics[width=0.50\textwidth]{figures/evaluation_and_results/usa_map.png}
	\caption{Map of data center locations for real time price simulations}
	\label{fig:usa_map}
\end{figure}

A list of real time energy markets and locations is outlined in Table \ref{tab:list_of_real_time_markets}. 

\begin{table}[htbp]
\centering
\begin{tabular}{ll}
\toprule
 Energy market & Location \\
\midrule
	ISO New England &  Portland, Maine \\
	ISO New England &  Boston, Massachussetts \\
	PJM & Richmond, Virginia  \\
	PJM & Brighton, Michigan  \\
	PJM & Hatfield, Pennsylvania  \\
	PJM & Madison, Wisconsin  \\
	PJM & Georgetown, Ohio  \\
\bottomrule
\end{tabular}
\caption{List of real time energy markets and locations}
\label{tab:list_of_real_time_markets}
\end{table}





\subsection{Simulation Configuration Parameters} \label{ssec:simulation_configuration_parameters}

\subsubsection{Cloud settings}

As the simulator has been built to be highly configurable \cite{lucanin2015philharmonic} different cloud parameters can be adjusted to run simulations with different settings. In Table \ref{tab:list_of_cloud_parameters} the most relevant simulation parameters are listed. 

\begin{table}[htbp]
\centering
\begin{tabularx}{\textwidth}{l|l|X}
	Metric & Values & Description \\
\hline
	number of servers & 500 & The total number of servers across all locations \\
	number of virtual machines & 5000 & The total number of virtual machines over the whole simulation time period \\
	server cpus & $[4,8]$ & The number of CPUs per server uniformly distributed over the given interval \\
	server memory & $[8,16]$ & The amount of memory per server uniformly distributed over the given interval \\
	virtual machine cpus & $[1,4]$ & The number of CPUs per VM uniformly distributed over the given interval \\
	virtual machine memory & $[1,4]$ & The amount of memory per VM uniformly distributed over the given interval \\
	dirty page rate & $\{20,40,70,90\}$ & One of four dirty page rates in MB/s assigned to each VM \\
	SLA level & 99.95\% & A fixed SLA availability level applied to each VM \\
	VM duration & $\{1,2,5,8,12,24,48\}$ & A fixed set of duration values in hours applied uniformly to the set of VMs \\
	VM price & 4 \cent \ / h & The price of a VM in cent per hour \\
	bandwidth & $\{400,800,1000\}$ & One of 3 amounts of bandwidths in MBit/s set between each two locations \\
	bandwidth cost & 0.1 \cent \ / GB & Bandwidth costs in cent per GB \\
	server peak power & 200 W & The power a server draws when its resources are fully utilized \\
	server idle power & 100 W & The power a server draws when idle \\
	cpu resource weight & 0.7 & The weight associated with cpu power when calculating server utilization \\
	memory resource weight & 0.3 & The weight associated with memory when calculating server utilization \\
\end{tabularx}
\caption{List of cloud configuration parameters in the simulation}
\label{tab:list_of_cloud_parameters}
\end{table}

The number of servers and VMs per simulation has been adjusted such that the resulting utilization is reasonable, e.g.~with 1000 servers and 2000 VMs in total an average utilization of only about 1 \% has been achieved over a simulation period of 5 weeks. Thus raising the number of VMs and in turn reducing number of servers led to a more realistic utilization of 30\% to 40\%. 

The relation of number of resources per server to the amount of VM resources (i.e.~number of cpus, memory) has been defined such that capacity constraints will not be an issue in simulations. The same method has been applied to the relation of total number of servers to number of VMs. 

The dirty page rate has a direct impact on VM migration performance (see Section \ref{sec:modeling_migration_energy}) and therefore different values have been assigned to VMs to simulate different application behavior. In combination with bandwidth this may lead to a high variation in migration downtimes. 

The SLA level has been set to the most common value for internet cloud services \cite{google2015compute,amazon2013sla}. With different penalty levels greater downtimes directly impact resulting costs for cloud providers. 

A different set of duration values has been assigned to VMs in order to simulate different kinds of workloads. This includes VM durations of 1 to 48 hours for scientific or HPC applications. Long running VMs have been omitted to focus on short term applications. 

The VM price most resembles the price for a ``n1-standard-1'' VM on Google Compute Cloud\footnote{\url{https://cloud.google.com/compute/pricing}}. As this is one of the smallest VMs available in the Google Cloud this price is still comparably cheap. 

Bandwidth is divided into low, medium and high values to simulate real world scenarios where high bandwidth may not always be available. As bandwidth has a direct impact on migration downtime this allows to evaluate the total resulting downtime and costs in different scenarios. 

Bandwidth costs have been set to a fixed price per amount of traffic while it is usually paid by fixed price contracts with 95/5 bandwidth constraints \cite{qureshi2009cutting}. These contracts measure traffic in fixed time intervals and the 95-th percentile of total usage is charged. To simplify the model in this work it has been set to a fixed price per volume. 

Server peak and idle power have been set where a server at peak load consumes double the amount of power than when idle. This may be too optimistic as it is stated that servers consume about 60\% of power when idle \cite{meisner2009powernap}. However studies show that new server technology is able to achieve power reductions up to 75\% from peak to idle mode \cite{prime2011energy}. 
A greater ratio of peak to idle power results in greater possibility for energy savings. Therefore the idle-to-peak ratio is critical for any scheduling algorithms aiming to reduce costs based on energy. 

CPU and memory resource weights have been defined to calculate resulting power consumption from server utilization of each resource. From investigations in \cite{meisner2009powernap,kansal2010virtual} it can be deduced that CPU is the most power consuming component where memory power consumption amounts to about one third up to equal amounts of CPU power. Therefore CPU and memory weights have been set to accommodate those findings. 



\subsubsection{Cloud scheduler} \label{sec:cloud_scheduler}

The core of the simulation is represented by the Cloud Scheduler. It is responsible for managing requests and for deciding which VMs should be migrated at which point in time. To make it a flexibel approach and be able to compare different scenarios the scheduler can be configured to run one out of seven different scenarios (Table \ref{tab:existing_scheduling_scenarios}). 


\begin{table}[htbp]
\centering
\begin{tabular}{lll}
\hline
  & \textbf{Request assignment} & \textbf{Migration handling} \\
\hline
	BFD baseline scheduler &  not cost aware, based on load & None \\
	BCF scheduler & cost aware, no forecasts & None \\
	BCF scheduler + FC & cost aware, forecasts & None \\
	BCF scheduler + Ideal FC & cost aware, ideal forecasts & None \\
	BCU scheduler + M & cost aware, no forecasts & cost aware, no forecasts \\
	BCU scheduler + M + FC & cost aware, forecasts & cost aware, forecasts \\
	BCU scheduler + M + ideal FC & cost aware, ideal forecasts & cost aware, ideal forecasts \\
\hline
\end{tabular}
\caption{Existing scheduling scenarios}
\label{tab:existing_scheduling_scenarios}
\end{table}

The first scheduler is a \textit{Best Fit Decreasing} (BFD) Scheduler that does no investigations on energy prices at all. It is based on a load balancing approach which aims to assign requests to the least occupied data center and utilize as few servers as possible to save energy costs. The BFD Scheduler is outlined in algorithm \ref{alg:bfd_scheduler}. 

The BFD scheduler iterates over the set of VM requests at the current point in time and aims to optimize placement of VMs by considering resource utilization of VMs and PMs for maximum consolidation. VM requests are sorted by resources in descending order to process VMs exhibiting large resource requirements first (line2). Locations are sorted by utilization ascending to assign requests first to under utilized locations (line 3). Lines 4 and 5 denote sorting of PMs by (free) capacities to consider most occupied servers first. 

\begin{algorithm}[htpb]
	\SetAlgoLined
	\SetKwProg{Fn}{Function}{:}{}
	\Fn{BFD Scheduler}{
		\KwData{Input Requests}
		\KwResult{Requests assigned according to BFD Schedule}
		sort VM requests with resource utilization in descending order\;
		sort locations by utilization in ascending order\;
		sort available PMs by location and free capacities in ascending order\;
		sort inactive PMs by capacities in ascending order\;
		
		\ForEach{vm in VM requests}{
			\While{vm not assigned {\normalfont and} size(available PMs) > 0}{
				\ForEach{pm in available PMs}{
					\If{vm fits on pm}{
						assign vm to pm\;
						remove vm from available PMs\;
						break\;
					}
				}
				
				\eIf{vm not assigned {\normalfont and} size(inactive PMs) > 0}{
					add first of inactive PMs to available PMs\;
					sort available PMs by location and free capacities ascending\;
				}{
					break\;
				}			
			}
		}
	}
\caption{Best fit decreasing scheduler}
\label{alg:bfd_scheduler}
\end{algorithm}

The BFD algorithm iterates over the set of requests and tries to assign VMs to hosts as long as non-fully occupied servers are available (line 7,8-14). In case a VM could not be assigned a server from the set of inactive hosts is activated and the aforementioned procedure is executed again (lines 15-17). In case no suitable host could be found or no further hosts are available the loop is exited with the current VM not being assigned (lines 18-19). 

As discussed before Table \ref{tab:existing_scheduling_scenarios} describes further scenarios with different scheduling algorithms. 
These algorithms are based on the \textit{Best Cost Fit} (BCF) and \textit{Best Cost Utility} (BCU) Scheduler with different variations to include migrations (denoted by \textit{M}), forecasts (denoted by \textit{FC}) and ideal forecasts (denoted by \textit{ideal FC}). 

The next discussed algorithm is the one from the Best Cost Fit scheduler which aims to maximize cost savings when assigning requests utilizing price forecasts. The corresponding algorithm is outlined in \ref{alg:bcf_scheduler}. 

\begin{algorithm}[htpb]
	\SetAlgoLined
	\SetKwProg{Fn}{Function}{:}{}
	\Fn{BCF Scheduler}{
		\SetKwInOut{Input}{Data}
    \SetKwInOut{Output}{Result}
		\Input{Input Requests \\
						flag for forecasts (FC)\\
						flag for ideal FC (idealFC)}
		\KwResult{Requests assigned according to BCF Schedule and given scenario}
		sort VM requests with resource utilization in descending order\;
		
		maxH <- 1\;
		\If{FC}{maxH <- get max fc horizon from config\;}
		
		\ForEach{vm in VM requests}{
			dur <- get remaining duration for vm\;
			\eIf{dur <= 1}
			{FC <- false\;idealFC <- false\;}
			{maxH <- min(dur,maxH)\;}
			
			fcData <- get sorted price and forecast data (FC, idealFC)\;
		
			\ForEach{data in fcData}{
				h <- get forecast horizon (data)\;
				loc <- get location (data)\;
				assign to host BFD (vm, loc)\;
				\If{assigned}{
					block vm for the next h time periods\;
					break\;
				}
			}
		}
	}
\caption{Best cost fit scheduler}
\label{alg:bcf_scheduler}
\end{algorithm}


The best cost fit scheduler takes three inputs: The VM requests, a flag denoting whether forecasts should be enabled and a second flag for possible inclusion of ideal forecasts. In line 2 requests are sorted descending by their resource requirements which resembles the step in the BFD scheduler. 

Lines 3-6 determine the maximum forecast horizon that should be taken into account when considering future energy prices (in case forecasts are enabled). From lines 7-11 the set of VM requests is iterated and forecasts are enabled based on the remaining duration. Line 13 determines the forecast horizon that will be applied through a minimum function of the remaining VM duration and the maximum forecast horizon defined previously. 

In line 15 a procedure is called to retrieve locations and best estimated forecast windows for these locations. Thus for each location and forecast horizon the average estimated energy price is calculated and results are sorted by price ascending such that the location with the least expected costs regarding a specific forecast horizon is placed first. 

\begin{algorithm}[htpb]
	\SetAlgoLined
	\SetKwProg{Fn}{Function}{:}{}
	\Fn{BCU Scheduler}{
		\SetKwInOut{Input}{Data}
    \SetKwInOut{Output}{Result}
		\Input{Input Requests \\
						Current cloud state \\
						flag for forecasts (FC)\\
						flag for ideal FC (idealFC)}
		\KwResult{A list of VMs with resulting utility value above the utility threshold}
		[slaPen,migEnergy,maxMigEnergy,remDur,maxRemDur,util,estimatedSavings] <- prepare utility function (FC, idealFC)\;
		
		uResult <- []\;
			
		\ForEach{vm in VM requests}{
		
			currentLoc <- getLocation(vm)\;
			uValue <- []\;
		
			\ForEach{loc in locations}{
				\If{loc != currentLoc}{
					
					slaPenalty <- 1 - slaPen[vm][loc]\;
					migrationEnergy <- 1 - (migEnergy[vm][loc] / maxMigEnergy)\;
					remainingDur <- remDur[vm] / maxRemDur\;
					dcLoad <- getRelativeDCLoad (util, currentLoc)\;
					costSavings <- estimatedSavings[vm][loc]\;
					
					result <- wSLA * slaPenalty + wMig * migrationEnergy + wDur * remainingDur + wLoad * dcLoad + wCost * costSavings\;
					
					uValue [loc] <- result\;
				}	
			}
			
			maxUValue <- max(uValue)\;
			append (uResult, (vm, getLocation(maxUValue), getUtilityValue(maxUValue)))\;
		}
		
		sort uResult by utility value descending\;
		result <- []\;
		uTH <- get utility TH from config ()\;
		
		\ForEach{r in uResult}{
			\If{utilityValue(r) > uTH}{
				append (result, r)\;
			}
		}
		
		return result\;
	}
\caption{Best cost utility scheduler}
\label{alg:bcu_scheduler}
\end{algorithm}

In lines 16 to 24 the resulting dataset from line 15 is iterated and the forecast horizon and location from the cheapest to more expensive locations are retrieved. For each of these data it is tried to assign the VM to a host from the given location based on a BFD approach. If the VM could be assigned successfully the VM will be blocked for migrations for the next $h$ time periods to prevent oscillation of VMs between different locations. 

The last scheduler is the Best Cost Utility Scheduler that takes into account VM migrations between different locations based on a utility function (see Section \ref{ssec:cloud_scheduler_and_utility_function} for a definition of the utility function). 
The algorithm of the BCU scheduler is shown in \ref{alg:bcu_scheduler}. 

Line 2 of the algorithm calls the procedure \textit{prepare utility function} that returns a list of metrics depending on the flags \textit{FC} and \textit{idealFC}. Results of utility calculations are stored in \textit{uResult} in line 3. 

From lines 4-6 start iterating over the set of VM requests and prepare the current location and a list of utility values. In addition lines 7 and 8 start iterating over the set of locations where the current location is skipped for migration. From line 9 to 13 the different criteria values are normalized from the results of the procedure in line 2. A list of criteria regarding this utility function can be found in Section \ref{ssec:cloud_scheduler_and_utility_function}. 

In line 14 the total utility value is calculated where each normalized criteria is weighted with its corresponding weight. The total utility value  is stored in line 15 for the current VM \textit{vm} and location \textit{loc}. Line 18 calculates the maximum utility value for this VM over all locations. That is, the most promising location where VM \textit{vm} could be migrated to is estimated. 

In line 19 a tuple consisting of \textit{(vm, loc, uvalue)} is added to the result utility list where \textit{uvalue} is the maximum of the calculated utility values for VM \textit{vm} associated with location \textit{loc}. 
Line 21 sorts the result utility list by utility value descending and line 22 and 23 are preparing the final result list and the utility threshold, which is taken from a configuration file. 

Lines 24 to 28 iterate over the resulting utility list and add values to the final result list in case the corresponding utility value exceeds the predefined utility threshold \textit{uTH}. 
The algorithm is concluded by returning the list of result VMs with total utility values above the utility threshold in line 29. 



\subsection{Cost models} \label{ssec:cost_model_definitions}

Cost models and related metrics are an important base for transforming aggregated power values to actual costs. Therefore a number of formulas have been defined to accurately model the resulting power consumption and energy costs. 
%These formulas are outlined below. 

\paragraph{Utilization of servers}
The basis for modeling power consumption is to define resource utilization of servers since server utilization relates directly to resulting power consumption \cite{meisner2009powernap}. 
Server utilization based on a set of resources $R$ is defined in Equation \ref{eq:server_utilization}. 

\begin{equation}
	s_{util}(t) = \sum_{r \in R} w_r \frac{s_{used}(r,t)}{s_{cap}(r)}
	\label{eq:server_utilization}
\end{equation}

with $w_r$ denoting the weight of resource $r$, $s_{used}$ is the currently used capacity of server $s$ regarding resource $r$ at time $t$, $s_{cap}$ denotes the total capacity of server $s$ of resource $r$ and $s_{util}$ being the resulting utilization of the server. 


\paragraph{Utilization per location}
In order to calculate data center load for each location a method of computing the average utilization per location is needed. 
It is defined as the average utilization of all servers in a given location (Equation \ref{eq:utilization_per_location}): 

\begin{equation}
	util_{loc}(t) = \frac{1}{|loc_{s}|} \sum_{s \in loc_{s}} s_{util}(t)
\label{eq:utilization_per_location}
\end{equation}

where $loc_{s}$ being the set of servers at location $loc$ and $util_{loc}$ denotes the current utilization at location $loc$. 


\paragraph{Power per location}

From the previous metric \textit{utilization per location} the resulting cloud power per location can be derived (Equation \ref{eq:power_loc}). 

\begin{equation}
	power_{loc}(t) = util_{loc}(t) \cdot |loc_{active_s}(t)| \cdot (P_{peak} - P_{idle}) + |loc_{active_s}(t)| \cdot P_{idle}
\label{eq:power_loc}
\end{equation}

where $|loc_{active_s}(t)|$ is the number of active servers at location $loc$ at time $t$, $P_{peak}$ is the peak power of the server and $P_{idle}$ describes the idle power of the server. 

\paragraph{Total cloud power}

The total cloud power is the sum of power consumption over all locations $L$ and time periods $T$ (Equation \ref{eq:m_tcp}). 

\begin{equation}
	m_{TCP} = \sum_{t \in T} \sum_{loc \in L} power_{loc}(t)
\label{eq:m_tcp}
\end{equation}


\paragraph{Migration load}
This metric serves as the basis for calculating migration energy as it directly depends on migration load. In addition it is used for further metrics such as migration costs. The formula for aggregated migration load per time $t$ is outlined in Equation \ref{eq:migration_load}.

\begin{equation}
	mig_l(t) = \sum_{v \in VM} V_{mig}(v,t)
\label{eq:migration_load}
\end{equation}

where $VM$ denotes the set of all active VMs at time $t$ and $V_{mig}(v,t)$ is the total migration load for vm $v$ for a migration starting at time $t$. The latter expression is taken from the definition of migration energy in Section \ref{sec:modeling_migration_energy}. 

\paragraph{Migration energy}
Modeling migration energy is needed for calculating the migration costs and it may also give a hint for resulting downtime and possible penalty costs due to the amount of migration energy consumed. 
The formulas for summed migration energy over the set of all VMs $VM$ and total migration energy over a simulation time period are denoted in Equations \ref{eq:migration_energy_by_time} and \ref{eq:migration_energy_total}. 

\begin{align}
	mig_e(t) = \sum_{v \in VM} E_{mig}(v,t) \label{eq:migration_energy_by_time}\\
	m_{ME} = \sum_{t \in T} mig_e(t) \label{eq:migration_energy_total}
\end{align}

\paragraph{Migration cost}
The migration costs are defined on the one side by combining resulting migration energy with current energy prices and on the other side by combining migration load and bandwidth costs. 

\begin{align}
	p_{mean}(t) &= \frac{p_{l1}(t) + p_{l2}(t)}{2} \label{eq:p_mean} \\
	mig_c(t) &= mig_e(t) \cdot p_{mean}(t) \label{eq:mig_c} \\
	mig_{c_{bw}}(t) &= mig_l(t) \cdot c_{bw} \label{eq:mig_c_bw} \\
	m_{MC} &= \sum_{t \in T} \left( mig_c(t) + mig_{c_{bw}}(t) \right) \label{eq:m_mc} 
\end{align}

Equation \ref{eq:p_mean} shows the mean price calculated from prices $p_{l1}$ and $p_{l2}$ in locations $l1$ and $l2$ at time $t$. 
Equation \ref{eq:mig_c} describes the migration costs depending on the migration energy and mean energy price $p_{mean}$ at time $t$. 
The bandwidth related costs for migration are outlined in Equation \ref{eq:mig_c_bw} with migration load and bandwidth costs combined (i.e.~amount of GB multiplied by \cent \ / GB). The migration cost metric $m_{MC}$ in Equation \ref{eq:m_mc} is then the sum of both energy and bandwidth costs. 

\paragraph{Cost of VM}
The resulting costs $v_c$ for a user of a VM is defined as the price $v_p$ set for the VM multiplied by its duration up to time $t$ (Equation \ref{eq:cost_of_vm}). 

\begin{equation}
	v_c(t) = v_p \cdot v_{dur}(t)
\label{eq:cost_of_vm}
\end{equation}

\paragraph{Penalty cost}

The total penalty costs are the aggregated costs for all penalties and VMs occurred during a simulation. Penalty costs occur when the maximum allowed downtime for a VM regarding an SLA threshold is exceeded. Depending on the threshold that has been surpassed different penalty costs have to be paid. 
As described in Section \ref{sec:sla_managemenet} three different penalty thresholds are defined which result in different penalty costs. 

\begin{align}
	SLA_{TH_i}(v,t) &= v_{dur}(t) \left( 1 - \frac{v_{SLA_i}}{100} \right), i \in \{1,2,3\} \label{eq:sla_th_i} \\
	v_{SLA_1} &= 99.95, v_{SLA_2} = 99, v_{SLA_3} = 95 \label{eq:sla_levels} \\
	v_{pen}(t) &= \left\{
								\begin{array}{@{}ll@{}}
									0.5, & \text{if } down_{acc}(v,t) > SLA_{TH_3}(v,t) \\
									0.25, & \text{if } down_{acc}(v,t) > SLA_{TH_2}(v,t) \\
									0.1, & \text{if } down_{acc}(v,t) > SLA_{TH_1}(v,t) \\
									0, & \text{otherwise}
								\end{array}\right. \label{eq:v_pen}  \\
	v_{c_{pen}}(t) &= v_c(t) \cdot v_{pen}(t) \label{eq:v_c_pen} \\
	m_{TPC} &= \sum_{v \in VM} v_{c_{pen}}(t_{last}) \label{eq:m_pc} 
\end{align}

Equation \ref{eq:sla_th_i} defines an SLA threshold for either of the defined SLA levels in Equation \ref{eq:sla_levels}. In Equation \ref{eq:v_pen} penalty values in the interval [0,1] are assigned based on the SLA threshold reached. This penalty value is then applied to the costs of the VM in Equation \ref{eq:v_c_pen} resulting in penalty costs for VM $v$. Equation \ref{eq:m_pc} calculates the total penalty costs across all VMs at the last simulation time stamp $t_{last}$. 


\paragraph{Total downtime}

The total downtime is calculated from the sum of downtimes of all VMs over the whole simulation time period (up to $t_{last}$, Equation \ref{eq:m_tdt}). 

\begin{equation}
	m_{TDT} = \sum_{v \in VM} down_{acc}(v,t_{last})
\label{eq:m_tdt}
\end{equation}

\paragraph{Number of migrations}

The total number of migrations is defined as the sum of migrations at each time stamp $t$ (Equation \ref{eq:num_migrations}). 

\begin{equation}
	m_{NM} = \sum_{t \in T} mig_{num} (t) 
\label{eq:num_migrations}
\end{equation}

where $mig_{num}(t)$ denotes the number of migrations at time $t$. 


\paragraph{Total cloud costs}

The total cloud costs are calculated as the sum of cloud power values multiplied by the price at the respective location and time (Equation \ref{eq:m_tcc}). 

\begin{equation}
	m_{TCC} = \sum_{t \in T} \sum_{loc \in L } power_{loc}(t) \cdot p_{loc}(t)
\label{eq:m_tcc}
\end{equation}

\paragraph{Total cloud power with migrations}

Calculating the total cloud power including migrations is a simple addition of the total cloud power and migration energy (Equation \ref{eq:m_tcpwm}). 

\begin{equation}
	m_{TCPWM} = m_{TCP} + m_{ME}
\label{eq:m_tcpwm}
\end{equation}

\paragraph{Total cloud cost with migrations}

Analogously to \textit{Total power with migrations} this metric is defined as the sum of total cloud cost and migration cost (Equation \ref{eq:m_tccwm}). 

\begin{equation}
	m_{TCCWM} = m_{TCC} + m_{MC}
\label{eq:m_tccwm}
\end{equation}

\paragraph{Total power}

The total power metric encompasses the metric \textit{Total cloud power with migrations} to describe the total power consumption in the simulation (Equation \ref{eq:m_tp}). 

\begin{equation}
	m_{TP} = m_{TCPWM}
\label{eq:m_tp}
\end{equation}

\paragraph{Total cost}

Total cost denote the sum of all cost occurred during simulation which includes the total cloud cost with migrations plus total penalty costs (Equation \ref{eq:m_tc}). 

\begin{equation}
	m_{TCCWM} = m_{TCCWM} + m_{TPC}
\label{eq:m_tc}
\end{equation}









\section{Utility function optimization} \label{sec:utility_function_optimization}

As explained in Section \ref{sec:cost_optimization_based_on_utility_function} the scheduler incorporates a utility function to provide a means of flexibel adjustments to different cloud criteria. This section aims to optimize the parameters of the utility function regarding both energy cost savings and SLA penalties. The resulting settings will then be used in large scale simulations which will be presented in Section \ref{sec:simulation_results}. 

In the following simulations the scheduler operates on the defined cloud parameters in Section \ref{ssec:simulation_configuration_parameters}. 
For the utility test scenarios outlined in this section the number of servers and VMs is changed to a total of 1000 servers and 2000 VMs over the whole simulation time period. This gives sufficient opportunity to test the utility function but does not require huge computational resources. 

The simulation runs in this section are based on 5 weeks of energy price data from day ahead markets with locations defined in Section \ref{sec:definition_of_simulation_scenarios}. As a common setting to these simulations the following bandwidth connections have been defined for day ahead scenarios between locations (Table \ref{tab:bandwidth_connections_in_da_markets}). To simplify the scenario all bandwidth connections are symmetric, i.e.~the same in- and outgoing bandwidth connections have been used between each two locations. 


\begin{table}[htbp]
\centering
\begin{tabular}{lll}
\toprule
	Source & Destination & Bandwidth \\
\midrule
	Hamina & Potsdam & 1000 MBit/s \\
	Hamina & St. Ghislain & 800 MBit/s \\
	Potsdam & St. Ghislain & 800 MBit/s \\
	Boston & Portland & 800 MBit/s \\
	Europe & USA & 400 MBit/s \\
\bottomrule
\end{tabular}
\caption{Bandwidth connections in day ahead market locations}
\label{tab:bandwidth_connections_in_da_markets}
\end{table}

The connection Europe to USA denotes connections from any country from Europe to any country in the USA which is mapped to 400 MBit/s. 

In order to easily distinguish between different schedulers a characterizing symbol has been introduced to designate each scheduler. The resulting mapping is shown in Table \ref{tab:scheduler_name_mapping}.

\begin{table}[htbp]
\centering
\begin{tabular}{lll}
\toprule
  Scheduler name & Symbol \\
\midrule
	BFD baseline scheduler & BFD \\
	BCF scheduler & BCF \\
	BCF scheduler + FC & BCF\_F \\
	BCF scheduler + Ideal FC & BCF\_IF \\
	BCU scheduler + M & BCU\_M \\
	BCU scheduler + M + FC & BCU\_MF \\
	BCU scheduler + M + ideal FC & BCU\_MIF \\
\bottomrule
\end{tabular}
\caption{Existing scheduling scenarios}
\label{tab:scheduler_name_mapping}
\end{table}


For a reference of all implemented cloud metrics shown in subsequent graphs these metrics are outlined in Table \ref{tab:list_of_cloud_metrics} (see also Section \ref{ssec:cost_model_definitions}). 


\begin{table}[htbp]
\centering
\begin{tabularx}{\textwidth}{llX}
\toprule
  Cloud metric & Symbol & Description \\
\midrule
	Total cloud power & TCP & The total power consumed by active servers aggregated over all locations and time periods \\
	Total cloud cost & TCC & The total costs resulting from applying energy prices to power consumption over the simulation time period \\
	Migration energy & ME & Migration energy summed up from all migrations over the simulation time period \\
	Migration cost & MC & Migration costs summed up from all migrations over the simulation time period \\
	Total cloud power & TCPWM & The total cloud power including the migration energy \\
	with migrations & & \\
	Total cloud cost & TCCWM & The total cloud costs including the resulting migration \\
	with migrations & & costs \\
	Total penalty cost & TPC & Total penalty costs occurred during the simulation time period \\
	Total downtime & TDT & Total downtime aggregated over the simulation time period \\
	Number of migrations & NM & Number of migrations triggered over the simulation time period \\
	Total power & TP & The total cloud power including the migration energy \\
	Total cost & TC & The total cloud costs including migration costs and total penalty costs \\
\bottomrule
\end{tabularx}
\caption{List of all measured cloud metrics}
\label{tab:list_of_cloud_metrics}
\end{table}

As might be noticed the metrics \textit{Total cloud power with migrations} and \textit{Total power} are defined the same since on the one side no more power values are to be added and on the other side a total metric comparable to the \textit{Total cost} should to be defined. 


In the following sections three different scenarios are defined to show the impact of changing utility parameters on resulting costs and SLA penalties.

\subsection{Scenario1: Energy utility function}

The first scenario consists of parameters to emphasize the reduction of migration energy consumption whereby less weights have been put on prevention of SLA penalties. 
The utility criteria and corresponding weights are outlined in Table \ref{tab:list_of_energy_utility_criteria_weights}. 

\begin{table}[htbp]
\centering
\begin{tabular}{lll}
\toprule
	Index & Name of criterion	& weight \\
\midrule
	$c_1$ & probability of SLA penalty & 0.4 \\
	$c_2$ & estimated migration energy & 0.7 \\
	$c_3$ & remaining VM duration & 0.5 \\
	$c_4$ & data center load & 0.4 \\
	$c_5$ & estimated cost benefit & 0.8 \\
	$ut$ & utility threshold & 1.8 \\
\bottomrule
\end{tabular}
\caption{List of energy utility criteria with associated weights}
\label{tab:list_of_energy_utility_criteria_weights}
\end{table}

We can observe that the \textit{estimated cost benefit} and \textit{estimated migration energy} criteria have been given the highest weights whereas other criteria such as \textit{probability of SLA penalty} are set to lower weights. 
The utility threshold value of 1.8 is the minimum value that has to be reached by a VM's utility function for the VM to be considered eligible for migration. 

Since all criteria values are normalized to the interval $[0,1]$ it can be quite easily estimated which values of the different criteria lead to utility values above the utility threshold. A trivial method of estimating utility weights is to set all criteria values to 1 and calculate the sum of their weights. This should result in a value signficantly greater than the utility threshold. One could also put particularly high emphasis on one criterion by keeping the sum of weights of all other criteria below the weight of this criterion. Then by setting the utility threshold to a value at least as high as that specific criterion it is assured that a sufficiently high value of this criterion is required to get above the utility threshold. 

The results for normalized power vs cost values are depicted in Figure \ref{fig:energy_utility_power_vs_cost}. 

\begin{figure}[htbp]
	\centering
		\includegraphics[width=1.00\textwidth]{figures/evaluation_and_results/energy_utility_power_vs_cost.pdf}
	\caption{Normalized cost vs power values based on the energy utility scenario}
	\label{fig:energy_utility_power_vs_cost}
\end{figure}

This graph outlines the resulting power and costs for this utility scenario across all defined schedulers (see Section \ref{sec:cloud_scheduler} for a definition of the schedulers). What can be observed is that power values differ only marginally while energy costs differ substantially between different schedulers. The BFD scheduler is taken as the baseline scheduler to which all other schedulers are compared. 

In this scenario the BFD scheduler exhibits the highest power consumption among all schedulers but less total costs than the BCU\_M scheduler. Overall the BCU schedulers (BCU\_M, BCU\_MF, BCU\_MIF) are not able to reduce costs as much as BCF schedulers (BCF, BCF\_F, BCF\_IF). Thus the utility function which is applied in BCU schedulers is not well calibrated. This behavior can be explained as we put on a high weight for the \textit{estimated cost benefit} criteria but a low weight on \textit{probability of SLA penalties} which allows the use of excessive migrations that can result in increased SLA penalty costs. 

The total resulting costs including migration costs and SLA penalty costs is shown in Figure \ref{fig:energy_utility_total_cost}. 
What is clearly visible are the added penalty and migration costs for the schedulers BCU\_M, BCU\_MF and BCU\_MIF. Therefore even though the cloud cost may be reduced compared to other schedulers the total costs are higher due to these additional costs. 

\begin{figure}[htbp]
	\centering
		\includegraphics[width=0.7\textwidth]{figures/evaluation_and_results/energy_utility_total_cost.pdf}
	\caption{Total resulting costs per scheduler for the energy utility scenario}
	\label{fig:energy_utility_total_cost}
\end{figure}

A diagram summarizing all the cloud metrics is depicted in Figure \ref{fig:energy_utility_cloud_metrics}. For a list of cloud metrics see Table \ref{tab:list_of_cloud_metrics}. 

\begin{figure}[bp]
	\centering
	\hspace*{-1.6in}
		\includegraphics[width=1.50\textwidth]{figures/evaluation_and_results/energy_utility_cloud_metrics.pdf}
	\caption{Cloud metrics calculated for the energy utility over the simulation time period}
	\label{fig:energy_utility_cloud_metrics}
\end{figure}

This diagram shows normalized values of cloud metrics over the whole simulation time period. Significant deviations of values can be observed for different schedulers. The results coincide with the graphs shown before as total cloud power values decrease only marginally while total cloud costs are reduced significantly (i.e.~BFD scheduler compared to BCU\_MIF scheduler for metrics TCP and TCC). 

Since migration energy and migration costs are directly proportional the normalized values are exactly the same. They are highest for the BCU\_M scheduler and decrease for BCU\_MF and BCU\_MIF schedulers since the latter ones include forecasts in the calculations. Other schedulers do not exhibit any migration energy or costs since no migrations are performed. 

The total cloud power with migrations (TCPWM) is almost identical to the TCP metric since migration energy only accounts for a very small fraction of the total cloud power. The total cloud costs with migrations (TCCWM) show a significantly different behavior due to the addition of migration costs based mainly on bandwidth costs. 

In the total penalty cost (TPC) metric the BCU\_M scheduler exhibits the highest penalty costs. It shows a similar behavior to the TCCWM metric as higher migration costs and therefore a higher number of migrations generally lead to increased penalty costs. 
In accordance with the penalty costs and migration costs the total downtime shows similar patterns as penalty costs are directly related to VM downtime. 

The number of migrations (NM) metric again shows similar behavior as the aforementioned metrics all relate to the total number of migrations. The total power (TP) metric is identical to the TCPWM metric and shown on the right for easier comparison to the total cost (TC) metric. 

The total cost metric adds to the pattern of TCCWM as in addition to cloud and migration costs the penalty costs are taken into account. 
Thus it can be concluded that due to high migration and penalty costs the BCU schedulers result in increased costs compared to the BCF schedulers. 


\subsection{Scenario2: Cost utility function}

The cost utility function is defined as utility scenario 2 where the focus has been laid on high cost optimization with other metrics having low priority. 

In Table \ref{tab:list_of_cost_utility_criteria_weights} the weights for the cost utility function are displayed. 

\begin{table}[htbp]
\centering
\begin{tabular}{lll}
\toprule
	Index & Name of criterion	& weight \\
\midrule
	$c_1$ & probability of SLA penalty & 0.3 \\
	$c_2$ & estimated migration energy & 0.4 \\
	$c_3$ & remaining VM duration & 0.2 \\
	$c_4$ & data center load & 0.1 \\
	$c_5$ & estimated cost benefit & 1.0 \\
	$ut$ & utility threshold & 1.4 \\
\bottomrule
\end{tabular}
\caption{List of cost utility criteria with associated weights}
\label{tab:list_of_cost_utility_criteria_weights}
\end{table}

A very high value has been set for the \textit{estimated cost benefit} criterion equaling to the sum of all other criteria. The utility threshold has been set to a value higher than the sum of all criteria but the cost benefit, therefore this threshold cannot be reached without a significantly high value of the cost benefit. 

\textit{Probability of SLA penalty} and \textit{estimated migration energy} are weighted higher than other criteria but exhibit still a low value compared to the cost benefit. Thus it is expected that costs will be optimized with still a fraction existing for migration and penalty costs. 

The normalized cost vs power graph is shown in Figure \ref{fig:cost_utility_power_vs_cost}. 

\begin{figure}[htbp]
	\centering
		\includegraphics[width=1.00\textwidth]{figures/evaluation_and_results/cost_utility_power_vs_cost.pdf}
	\caption{Normalized cost vs power values based on the cost utility scenario}
	\label{fig:cost_utility_power_vs_cost}
\end{figure}

This graph shows more evenly distributed cost values than the one from scenario 1 (Figure \ref{fig:energy_utility_power_vs_cost}). Thus the BFD scheduler almost reaches the maximum cost value but the BCU\_M scheduler still shows the highest costs of all schedulers. It can be noticed that the BCU schedulers are at the same levels as BCF schedulers with the BCU\_MF scheduler showing only a minor increase in costs in comparison to the BCF\_F scheduler exhibiting the least costs. 

\begin{figure}[bp]
	\centering
		\includegraphics[width=0.7\textwidth]{figures/evaluation_and_results/cost_utility_total_cost.pdf}
	\caption{Total resulting costs per scheduler for the cost utility scenario}
	\label{fig:cost_utility_total_cost}
\end{figure}


The total costs are depicted in Figure \ref{fig:cost_utility_total_cost}. Compared to the total cost chart of scenario 1 (Figure \ref{fig:energy_utility_total_cost}) the total costs for all schedulers except the BFD scheduler have been reduced. Also the fraction of migration and penalty costs could be reduced except for the BCU\_M scheduler with a slight increase of penalty costs. 

In Figure \ref{fig:cost_utility_cloud_metrics} the resulting cloud metrics are shown. 

\begin{figure}[htbp]
	\centering
	\hspace*{-1.2in}
		\includegraphics[width=1.50\textwidth]{figures/evaluation_and_results/cost_utility_cloud_metrics.pdf}
	\caption{Cloud metrics calculated for the cost utility over the simulation time period}
	\label{fig:cost_utility_cloud_metrics}
\end{figure}

The most obvious changes compared to the energy utility scenario are the decreased migration energy, migration cost, total penalty cost, total downtime and number of migration criteria (ME, MC, TPC, TDT and NM) for the BCU\_MF and BCU\_MIF schedulers in relation to the BCU\_M scheduler. 

Thus fewer migrations lead to fewer downtimes, SLA violations and penalties and also migration energy and costs. The reason that the latter two BCU schedulers perform significantly better than the BCU\_M scheduler is the fact that the \textit{estimated cost benefit} metric has the most impact when applied to an extended time series with forecasts. 



\subsection{Scenario3: Best utility function} \label{ssec:best_utility_function}

The best utility function has been defined as the scenario with the highest cost savings compared to other scenarios. It puts emphasis on both reduction of SLA penalties as well as optimization of energy costs during the simulation. 

The defined weights assigned to the different criteria are denoted in Table \ref{tab:list_of_best_utility_criteria_weights}. 

\begin{table}[htbp]
\centering
\begin{tabular}{lll}
\toprule
	Index & Name of criterion	& weight \\
\midrule
	$c_1$ & probability of SLA penalty & 1.0 \\
	$c_2$ & estimated migration energy & 0.1 \\
	$c_3$ & remaining VM duration & 0.2 \\
	$c_4$ & data center load & 0.1 \\
	$c_5$ & estimated cost benefit & 1.0 \\
	$ut$ & utility threshold & 2.0 \\
\bottomrule
\end{tabular}
\caption{List of best utility criteria with associated weights}
\label{tab:list_of_best_utility_criteria_weights}
\end{table}

As can be observed the \textit{probability of SLA penalty} and \textit{estimated cost benefit} metrics are given the highest possible weights while other criteria are weighted almost negligibly. The utility threshold amounts to the sum of the two highest weights making sure that only VMs with high relative values for metrics $c_1$ and $c_5$ are considered for migrations. 

\begin{figure}[bp]
	\centering
		\includegraphics[width=1.00\textwidth]{figures/evaluation_and_results/best_utility_power_vs_cost.pdf}
	\caption{Normalized cost vs power values based on the best utility scenario}
	\label{fig:best_utility_power_vs_cost}
\end{figure}

The power vs cost chart is given in Figure \ref{fig:best_utility_power_vs_cost}. 
The normalized costs are more evenly distributed across the schedulers than for scenarios 1 and 2 (Figures \ref{fig:energy_utility_power_vs_cost} and \ref{fig:cost_utility_power_vs_cost}). The BCU\_M scheduler still shows higher costs compared to other schedulers except the BFD scheduler. 
Power values also show small deviations of up to 2\% where most energy savings can be achieved by the BCU\_M and BCU\_MF schedulers. 

Total costs are depicted in Figure \ref{fig:best_utility_total_cost}. No penalty costs have resulted for this scenario which coincides with the adjustments of utility weights where highest weights were put on \textit{probability of SLA penalty} and \textit{estimated cost benefit} criteria. 
Also total costs could be reduced for schedulers BCU\_M, BCU\_MF and BCU\_MIF. 

\begin{figure}[tbp]
	\centering
		\includegraphics[width=0.7\textwidth]{figures/evaluation_and_results/best_utility_total_cost.pdf}
	\caption{Total resulting costs per scheduler for the best utility scenario}
	\label{fig:best_utility_total_cost}
\end{figure}

In Figure \ref{fig:best_utility_cloud_metrics} the resulting cloud metrics are shown. 

\begin{figure}[htbp]
	\centering
	\hspace*{-1.2in}
		\includegraphics[width=1.50\textwidth]{figures/evaluation_and_results/best_utility_cloud_metrics.pdf}
	\caption{Cloud metrics calculated for the best utility over the simulation time period}
	\label{fig:best_utility_cloud_metrics}
\end{figure}

What can be deduced by this graph is that cost and migration dependent metrics (TCCWM, TPC, TC) show substantially reduced values where no penalty costs are shown at all (TPC). The ME, MC, TDT and NM metrics show lower values as well in relation to the BCU\_M scheduler. 
Other metrics such as power values do not exhibit significant variations however emphasis have been put on cost rather than power reductions. 

The resulting cost reductions for all scenarios are shown in Table \ref{tab:utility_evaluation_results}. 
Cost reductions of cost and best utility scenarios in percent compared to the energy utility scenario have been denoted as cost (\%) and best (\%), respectively. 
The best utility scenario exhibits the least total costs where substantial cost reductions of up to 15\% (BCU\_M scheduler) have been achieved. It also provides the highest cost reductions compared to the energy utility scenario with further reduced costs for the BCU\_M, BCU\_MF and BCU\_MIF schedulers. 


\begin{table}[htbp]
\centering
\begin{tabular}{lccccc}
\toprule
{} &  energy &   cost &  cost (\%) &   best &  best (\%) \\
\midrule
BFD     &   88.47 &  86.84 &     -1.85 &  86.84 &     -1.85 \\
BCF     &   79.05 &  78.42 &     -0.80 &  78.42 &     -0.80 \\
BCF\_F   &   75.80 &  74.08 &     -2.27 &  74.08 &     -2.27 \\
BCF\_IF  &   75.64 &  75.92 &      0.38 &  75.92 &      0.38 \\
BCU\_M   &   95.82 &  89.72 &     -6.37 &  80.75 &    -15.73 \\
BCU\_MF  &   81.09 &  74.74 &     -7.83 &  74.66 &     -7.92 \\
BCU\_MIF &   82.86 &  78.78 &     -4.93 &  75.50 &     -8.88 \\
\bottomrule
\end{tabular}
\caption{Utility evaluation results for all scenarios (in \$)}
\label{tab:utility_evaluation_results}
\end{table}







\section{Simulation Results} \label{sec:simulation_results}

In this section the results of large scale simulations conducted for both day ahead and real time markets are presented. The simulations are based on energy price data from 2013 for two different time periods for each of day ahead and real time scenarios. 

An outline of the simulation scenarios with definition of cloud parameters has been given in Section \ref{sec:definition_of_simulation_scenarios}. 
A definition of simulation scenarios including corresponding time periods are shown in Table \ref{tab:simulation_scenarios}. 

\begin{table}[htbp]
\centering
\begin{tabularx}{\textwidth}{llX}
\toprule
  Scenario name & Time period & Description \\
\midrule
	DA Summer & 2013-06-20 to 2013-07-28 & A period of 5 weeks of day ahead energy price time series in summer 2013 \\
	DA Spring & 2013-01-02 to 2013-04-30 & A period of 4 months of day ahead energy price time series in spring 2013 \\
	RT Summer & 2013-06-20 to 2013-07-28 & A period of 5 weeks of real time energy price time series in summer 2013 \\
	RT Spring & 2013-01-02 to 2013-04-30 & A period of 4 months of real time energy price time series in spring 2013 \\
\bottomrule
\end{tabularx}
\caption{Definition of simulation scenarios}
\label{tab:simulation_scenarios}
\end{table}

\subsection{Common cloud parameters}

Common parameters have been set for both day ahead and real time markets as presented in Section \ref{ssec:simulation_configuration_parameters}. In addition some parameters have been amended to fit the different simulation scenarios. 
One of those parameters is the bandwidth between locations which is defined as common setting for each of day ahead and real time price simulations, respectively. 

Bandwidth mappings defined for both day ahead and real time simulations are outlined in Tables \ref{tab:day_ahead_bandwidth_mappings} and \ref{tab:real_time_bandwidth_mappings}. 


\begin{table}[htbp]
\centering
\begin{tabular}{lll}
\toprule
	Source & Destination & Bandwidth \\
\midrule
	Hamina & Potsdam & 1000 MBit/s \\
	Hamina & St. Ghislain & 800 MBit/s \\
	Potsdam & St. Ghislain & 800 MBit/s \\
	Boston & Portland & 800 MBit/s \\
	Europe & USA & 400 MBit/s \\
\bottomrule
\end{tabular}
\caption{Bandwidth connections in day ahead market locations}
\label{tab:day_ahead_bandwidth_mappings}
\end{table}


\begin{table}[htbp]
\centering
\begin{tabular}{lll}
\toprule
	Source & Destination & Bandwidth \\
\midrule
	ISO New England & ISO New England & 1000 MBit/s \\
	ISO New England & PJM & 800 MBit/s \\
	PJM & PJM & 1000 MBit/s \\
\bottomrule
\end{tabular}
\caption{Bandwidth connections in real time market locations}
\label{tab:real_time_bandwidth_mappings}
\end{table}

The day ahead bandwidth connections have already been defined in Section \ref{sec:definition_of_simulation_scenarios} which are included here for ease of reference. The real time bandwidth connections in the table are defined between different real time markets but do not consider individual locations. Thus if the same market is given for both source and destination it means that connections between locations from within this market exhibit the same bandwidth connection. When different markets for source and destination are given the defined bandwidth is valid for connections between locations of these two markets. 

As outlined in Table \ref{tab:additional_cloud_parameters} additional parameters have been set that influence the behavior of the simulations. The maximum forecast horizon is the maximum time period for which forecasts will be available. This is important for the metric that averages over current and future energy prices whereby forecasts with a longer time period of e.g.~one week will not provide accurate predictions. In this case it has been set to 12 hours ahead as it already provides reasonable forecasts but restricts estimations to allow for a more dynamic forecast environment. 

\begin{table}[htbp]
\centering
\begin{tabular}[\textwidth]{ll}
\toprule
	Cloud metric & Value  \\
\midrule
	maximum forecast horizon & 12  \\
	minimum price threshold & 0.1 \\
	minimum remaining duration & 1  \\
	maximum duration VMs & None \\
	VMs with additional SLA levels & None \\
\bottomrule
\end{tabular}
\caption{Additional cloud parameters for simulation scenarios}
\label{tab:additional_cloud_parameters}
\end{table}


The minimum price threshold is given in \cent \ / kWh where a VM will not be migrated to a location where price differences fall below the given threshold. It is set to a low value to allow for possibly excessive migrations if not prevented by the scheduler. 

The minimum remaining duration is set to the number of hours a VM has to be still running in order to be eligible for migration. Also in this case it has been set to the lowest possible value to not restrict migrations beforehand. 

Maximum duration VMs are VMs that run over the whole simulation time period. This has not been taken into account since migration behavior differs substantially when such VMs are included in the simulation which may be investigated in future work. 

Applying different SLA availability levels to VMs has not been considered since resulting penalty costs would not be coherent over the whole set of VMs. 

The utility values for all subsequent simulations will be taken from the \textit{best utility function} evaluated in the previous section. Since it provided promising results on a small scale cloud it is expected to perform well also in larger cloud environments. 

The average cloud utilization is calculated based on the total number of virtual machines, the simulation time period, number of servers and the average runtime of VMs. The corresponding formulas are depicted in Equations \ref{eq:average_utilization} and \ref{eq:average_duration}.

\begin{align}
	util_{avg} &=  \frac{|VM| \cdot dur_{avg}}{|T| \cdot |s|} \label{eq:average_utilization} \\
	dur_{avg} &= \frac{1}{|VM|} \sum_{v \in |VM|} v_{dur} \label{eq:average_duration}
\end{align}

The average VM runtime $dur_{avg}$ is calculated as the mean of all fixed VM duration values where VM assignments to durations follow the uniform distribution. The average utilization $util_{avg}$ is then the number of VMs multiplied by their average duration  in relation to the number of hourly time periods $|T|$ and the number of servers $|s|$ over all locations. 

Each simulation scenario has been run on all schedulers defined in \ref{sec:cloud_scheduler} where all previously defined cloud metrics are evaluated (Section \ref{ssec:simulation_configuration_parameters}). This results in a comprehensive evaluation of the defined schedulers across an extended time period. 
In addition forecast accuracy will be evaluated based on the simulated data. 

In the following sections each simulation scenario is presented in detail together with the results. 



\subsection{Simulation scenario DA Summer} \label{ssec:simulation_scenario_da_summer}

The first simulation scenario is based on a time period of 5 weeks of day ahead energy price data. 

The corresponding dataset is shown in Figure \ref{fig:da_sim_2013_5weeks}. The dataset exhibits strong seasonal patterns over each day and week. Locations St. Ghislain and Potsdam show the most stable seasonal periods where Hamina exhibits an almost exponential decline. Portland and Boston show regular seaonal periods as well except for one week in mid of July where the energy price levels increase drastically. 

\begin{figure}[htbp]
	\centering
		\includegraphics[width=1.0\textwidth]{figures/evaluation_and_results/da_sim_2013_5weeks.png}
	\caption{Day ahead energy prices over 5 weeks in 2013, in \$ per MWh}
	\label{fig:da_sim_2013_5weeks}
\end{figure}

The simulation has been run based on this dataset and previously defined cloud parameters. 
The following parameters have been set specifically for this simulation (Table \ref{tab:da_summer_cloud_parameters}). 


\begin{table}[htbp]
\centering
\begin{tabular}[\textwidth]{ll}
\toprule
	Cloud metric & Value  \\
\midrule
	number of servers & 500 \\
	number of servers per location & 100 \\
	number of virtual machines & 5000\\
\bottomrule
\end{tabular}
\caption{Cloud parameters for simulation scenario DA Summer}
\label{tab:da_summer_cloud_parameters}
\end{table}

The set of servers is distributed to locations such that each location is assigned to the same number of servers. Thus the number of servers has been chosen to accommodate the need for equal distribution regarding the number of locations. 


In this case the average utilization based on the calculation of Equation \ref{eq:average_utilization} would result in 15.7\%. 
Thus the cloud (number of servers, number of VMs) has been defined such that a sufficient amount of servers are available for VMs at each point in time and a reasonable value of cloud utilization is reached. 


Figure \ref{fig:DA_Summer_power_vs_cost} shows the results for normalized power vs cost for each scheduler. 
It can be noted that this shows very similar behavior to the results of the \textit{best utility function} in Section \ref{ssec:best_utility_function}. However in this simulation the BCU\_MF scheduler shows the least resulting costs relative to the baseline scheduler. This indicates a good performance of the utility function based on energy price forecasts which could outperform all other schedulers in terms of resulting costs. 

Figure \ref{fig:DA_Summer_total_cost} confirms these findings by displaying the total resulting costs for this simulation scenario. 
In this scenario no penalty costs due to migration downtimes have been resulted from any scheduler which attributes to high valued utility weights regarding SLA penalty and cost metrics. 

The resulting cloud metrics are depicted in Figure \ref{fig:DA_Summer_cloud_metrics}. This graph is similar to the cloud metrics of the best utility function with further reduced number of migrations of the BCU\_MF scheduler relative to the BCU\_M scheduler. Also total costs could be reduced due to less migration costs and less total cloud costs which is caused by a reduction of total power consumption. 

\begin{figure}[tbp]
	\centering
		\includegraphics[width=1.00\textwidth]{figures/evaluation_and_results/DA_Summer_power_vs_cost.pdf}
	\caption{Normalized power and costs for DA Summer simulation scenario}
	\label{fig:DA_Summer_power_vs_cost}
\end{figure}

\begin{figure}[htbp]
	\centering
	\vspace*{-0.2in}
		\includegraphics[width=0.7\textwidth]{figures/evaluation_and_results/DA_Summer_total_cost.pdf}
	\caption{Total resulting costs for DA Summer simulation scenario}
	\label{fig:DA_Summer_total_cost}
\end{figure}

\begin{figure}[bp]
	\centering
	\vspace*{-0.2in}
	\hspace*{-1.6in}
		\includegraphics[width=1.50\textwidth]{figures/evaluation_and_results/DA_Summer_cloud_metrics.pdf}
	\caption{Cloud metrics resulting from the DA Summer simulation scenario}
	\label{fig:DA_Summer_cloud_metrics}
\end{figure}




\subsection{Simulation scenario DA Spring} \label{ssec:simulation_scenario_da_spring}

This simulation scenario is based on a total of 4 months of day ahead energy price data which should prove the validity of the schedulers based on an extended simulation time period. 

Figure \ref{fig:da_sim_2013_4months} shows the underlying dataset on which this simulation is based. 
Different time series show very different behavior in energy price variations. For example, Portland and Boston exhibit an increase in energy price levels of up to a factor of 10 during the period from January to March compared to prices after this period. Energy prices for Hamina on the contrary show a much more stable mean with just one significant spike at the beginning of March. This should result in a challenging scenario in terms of accurate forecast calculations for each location. 



\begin{figure}[htbp]
	\centering
		\includegraphics[width=1.0\textwidth]{figures/evaluation_and_results/da_sim_2013_4months.png}
	\caption{Day ahead energy prices over 4 months in 2013, in \$ per MWh}
	\label{fig:da_sim_2013_4months}
\end{figure}

Simulation specific parameters have been set according to Table \ref{tab:da_spring_cloud_parameters}. Thus the number of servers and servers per location has been defined analogously to the DA Summer simulation scenario but the number of virtual machines has been adjusted to accommodate the extended simulation time period. This results in an average utilization (VMs per server and point in time) of 14.9\% across the simulation time period. 

\begin{table}[htbp]
\centering
\begin{tabular}[\textwidth]{ll}
\toprule
	Cloud metric & Value  \\
\midrule
	number of servers & 500 \\
	number of servers per location & 100 \\
	number of virtual machines & 15000\\
\bottomrule
\end{tabular}
\caption{Cloud parameters for simulation scenario DA Spring}
\label{tab:da_spring_cloud_parameters}
\end{table}

From the results in Figure \ref{fig:DA_Spring_power_vs_cost} it is clearly visible that substantial cost savings have been achieved in this scenario compared to the BFD baseline scheduler. Even though the energy price dataset has not been optimal for applying forecasting methods the BCU\_MF scheduler which triggers migrations based on forecasts again results in the largest cost savings. Surprisingly the scheduler BCU\_MIF which is based on ideal forecasts is outperformed by the BCU\_MF scheduler which is based on actual forecasts generated for this dataset. This phenomenon can be attributed to the fact that the BCU\_MIF scheduler is highly impacted by occurring price spikes which may result in a higher number of migrations and thus resulting costs. 

\begin{figure}[htbp]
	\centering
		\includegraphics[width=1.00\textwidth]{figures/evaluation_and_results/DA_Spring_power_vs_cost.pdf}
	\caption{Normalized power and costs for DA Spring simulation scenario}
	\label{fig:DA_Spring_power_vs_cost}
\end{figure}

This is also emphasized by the total cost chart in Figure \ref{fig:DA_Spring_total_cost}. Due to a fewer number of migrations and different scheduling decisions the BCU\_MF scheduler results in less cloud costs attributed to less resulting cloud power. It can also be observed that the migration cost have been reduced to a negligible but still existing fraction of the total costs except for the BCU\_M scheduler. Therefore the cost difference between the BCU schedulers is caused due to different scheduling decisions and server consolidation resulting in different power and cost levels.

The graph showing cloud metrics confirms the statements made above (Figure \ref{fig:DA_Spring_cloud_metrics}). Total cloud power as well as total cloud costs could be significantly reduced compared to the BFD scheduler. The number of migrations and therefore migration costs could be greatly reduced as well for BCU\_MF and BCU\_MIF schedulers. The difference in total costs between the BCF and BCU schedulers is small but still significant. Interestingly the BCF\_F scheduler which is based on real forecasts outperforms both BCF and BCF\_IF schedulers in the same manner as it has been explained for BCU schedulers above. 

Therefore the BCU\_MF scheduler provides the best results for this simulation scenario similar to the DA Summer simulation.  

\begin{figure}[htbp]
	\centering
		\includegraphics[width=0.7\textwidth]{figures/evaluation_and_results/DA_Spring_total_cost.pdf}
	\caption{Total resulting costs for DA Spring simulation scenario}
	\label{fig:DA_Spring_total_cost}
\end{figure}

\begin{figure}[htbp]
	\centering
	\hspace*{-1.2in}
		\includegraphics[width=1.50\textwidth]{figures/evaluation_and_results/DA_Spring_cloud_metrics.pdf}
	\caption{Cloud metrics resulting from the DA Spring simulation scenario}
	\label{fig:DA_Spring_cloud_metrics}
\end{figure}




\subsection{Simulation scenario RT Summer} \label{ssec:simulation_scenario_rt_summer}

This simulation scenario is again based on 5 weeks on energy price data however prices are retrieved from real time markets defined in Section \ref{sec:definition_of_simulation_scenarios}. 


Figure \ref{fig:rt_sim_2013_5weeks} shows the corresponding dataset for this simulation. Similar to the 5 week day ahead dataset it shows obvious daily and weekly seasonality with substantial increase in price levels beginning in mid of July. What is interesting to note is that all locations show similar price behavior over the whole simulation time period. This can be attributed to the fact that most of the locations are bound to the same energy market (PJM) and thus exhibit comparable patterns. Despite the locations Boston and Portland being associated with a different energy market (ISO New England) they show very similar patterns compared to the PJM locations. 

\begin{figure}[htbp]
	\centering
		\includegraphics[width=1.00\textwidth]{figures/evaluation_and_results/rt_sim_2013_5weeks.png}
	\caption{Real time energy prices over 5 weeks in 2013, in \$ per MWh}
	\label{fig:rt_sim_2013_5weeks}
\end{figure}

The parameters applicable to this scenario are shown in Table \ref{tab:rt_summer_cloud_parameters}. The number of servers and virtual machines has been adjusted to fit the greater number of locations in this scenario. The resulting average utilization according to Equation \ref{eq:average_utilization} would be 15.7\% which is equal to the utilization of the DA Summer simulation. 

\begin{table}[htbp]
\centering
\begin{tabular}[\textwidth]{ll}
\toprule
	Cloud metric & Value  \\
\midrule
	number of servers & 700 \\
	number of servers per location & 100 \\
	number of virtual machines & 7000\\
\bottomrule
\end{tabular}
\caption{Cloud parameters for simulation scenario RT Summer}
\label{tab:rt_summer_cloud_parameters}
\end{table}

The normalized cost chart depicted in Figure \ref{fig:RT_Summer_power_vs_cost} shows slightly different patterns than the simulation scenarios presented for day ahead energy prices. In particular the schedulers exhibiting ideal forecasts (BCF\_IF and BCU\_MIF) provide the best results and the most cost reductions. This may be attributed to the fact that the real time price dataset for this simulation does not exhibit as many ``outliers'' or price spikes as the dataset associated with the day ahead simulation over the same time period (DA Summer). Therefore the accurate ideal forecasts are not triggering too many unnecessary migrations and VMs do not need to be rescheduled as often leading to less power consumption and costs. 

\begin{figure}[htbp]
	\centering
		\includegraphics[width=1.00\textwidth]{figures/evaluation_and_results/RT_Summer_power_vs_cost.pdf}
	\caption{Normalized power and costs for RT Summer simulation scenario}
	\label{fig:RT_Summer_power_vs_cost}
\end{figure}

The same findings can be derived from the total cost chart in Figure \ref{fig:RT_Summer_power_vs_cost}. The BCU\_MIF scheduler results in slightly more migrations compared to the BCU\_MF scheduler but results in lower cost due to better utilization of the energy price differences for different locations. When comparing the BCU and BCF schedulers of the same type the former provide better performance than the latter in terms of cost reductions. Therefore it can be deduced that the utility functions operated at the BCU schedulers is well calibrated and provide reasonable results. 

The cloud metrics in Figure \ref{fig:RT_Summer_cloud_metrics} provide a detailed view on the results of the different metrics. Despite the increased power consumption caused by the BCU\_MIF scheduler it results in less total costs due to its ability to consider all occurring price differences. 
It also results in significantly more VM downtimes than the BCU\_MF scheduler however accumulated downtimes for individual VMs do not reach the penalty threshold. Therefore increased cost reductions come at the price of increased downtimes which are however not considered significant. 

\begin{figure}[htbp]
	\centering
		\includegraphics[width=0.7\textwidth]{figures/evaluation_and_results/RT_Summer_total_cost.pdf}
	\caption{Total resulting costs for RT Summer simulation scenario}
	\label{fig:RT_Summer_total_cost}
\end{figure}

\begin{figure}[htbp]
	\centering
	\hspace*{-1.6in}
		\includegraphics[width=1.50\textwidth]{figures/evaluation_and_results/RT_Summer_cloud_metrics.pdf}
	\caption{Cloud metrics resulting from the RT Summer simulation scenario}
	\label{fig:RT_Summer_cloud_metrics}
\end{figure}



\subsection{Simulation scenario RT Spring} \label{ssec:simulation_scenario_rt_spring}

The final simulation scenario is based on 4 months of real time energy prices. Analogously to the day ahead simulation DA Spring it exhibits the same time period but operates on a different dataset. The dataset associated with this simulation is outlined in Figure \ref{fig:rt_sim_2013_4months}. 

\begin{figure}[htbp]
	\centering
		\includegraphics[width=1.00\textwidth]{figures/evaluation_and_results/rt_sim_2013_4months.png}
	\caption{Real time energy prices over 4 months in 2013, in \$ per MWh}
	\label{fig:rt_sim_2013_4months}
\end{figure}

Comparable to the dataset of the RT Summer simulation the locations belonging to the same energy market (see Section \ref{sec:definition_of_simulation_scenarios}) show very similar patterns over time. The PJM market locations experience a significant price spike at the end of January with another substantial increase in price levels in mid of March. The patterns may be similar but not identical, therefore it may still be sensible to migrate between locations of the PJM market. The locations Boston and Portland show similar patterns as their day ahead counterparts (see Section \ref{ssec:simulation_scenario_da_spring}). Thus a significant increase in price levels and variation can be observed from mid of January to mid of February in the graph which may result in less accurate forecasts. 

The cloud parameters specific to this simulation are depicted in Table \ref{tab:da_spring_cloud_parameters}. The relation of number of VMs to number of servers has been set the same as for the DA Spring simulation for a comparable distribution of VMs to servers. Therefore the average cloud utilization for this simulation scenario is 14.9\% which is the same as for the DA Spring simulation. 

\begin{table}[htbp]
\centering
\begin{tabular}[\textwidth]{ll}
\toprule
	Cloud metric & Value  \\
\midrule
	number of servers & 700 \\
	number of servers per location & 100 \\
	number of virtual machines & 21000\\
\bottomrule
\end{tabular}
\caption{Cloud parameters for simulation scenario DA Spring}
\label{tab:da_spring_cloud_parameters}
\end{table}

The normalized power and cost graph shows different results from the RT Summer simulation (Section \ref{ssec:simulation_scenario_rt_summer}). In this scenario the schedulers operating on real forecasts provide the best results in contrast to the schedulers based on ideal forecasts in the RT Summer simulation. After the investigations in the previous sections it can be stated that this behavior can be deduced with high probability from the characteristics of the energy price dataset. 
As energy prices tend to be more volatile in this scenario the schedulers based on real forecasts show an advantage of averaging extreme price values. In the previous simulation the price volatility has not been as high therefore the ideal forecasts exhibited an advantage. 


\begin{figure}[htbp]
	\centering
		\includegraphics[width=1.00\textwidth]{figures/evaluation_and_results/RT_Spring_power_vs_cost.pdf}
	\caption{Normalized power and costs for RT Spring simulation scenario}
	\label{fig:RT_Spring_power_vs_cost}
\end{figure}

The total cost graph emphasizes these observations (Figure \ref{fig:RT_Spring_total_cost}). Compared to the DA Spring simulation (Section \ref{ssec:simulation_scenario_da_spring}) total costs show higher values for both cloud and migration costs. This can be attributed to the higher number of locations in this simulation which result in increased energy costs over the same simulation time period. 
As shown above the schedulers based on actual forecasts achieve the best results (BCF\_F, BCU\_MF). Thus the ``real'' forecast scheduler is suitable to be applied over a longer period of time with energy prices exhibiting high volatility. 

The resulting cloud metrics are depicted in Figure \ref{fig:RT_Spring_cloud_metrics}. Substantial power and cost reductions are clearly visible for total power and cost metrics. The BCU\_MF scheduler provides the best results with lowest energy costs and power consumption. In addition it experiences the least number of downtimes from all schedulers that include migrations (BCU\_M, BCU\_MF, BCU\_MIF). Therefore together with the findings earlier in this section it can be concluded that the BCU\_MF scheduler provides superior results for highly volatile energy price time series. 

\begin{figure}[htbp]
	\centering
		\includegraphics[width=0.7\textwidth]{figures/evaluation_and_results/RT_Spring_total_cost.pdf}
	\caption{Total resulting costs for RT Spring simulation scenario}
	\label{fig:RT_Spring_total_cost}
\end{figure}

\begin{figure}[htbp]
	\centering
	\hspace*{-1.2in}
		\includegraphics[width=1.50\textwidth]{figures/evaluation_and_results/RT_Spring_cloud_metrics.pdf}
	\caption{Cloud metrics resulting from the RT Spring simulation scenario}
	\label{fig:RT_Spring_cloud_metrics}
\end{figure}





\subsection{Utilization evaluation}

In order to better investigate the results presented in the previous sections the actual price time series vs their utilization levels have been investigated. Thus for each simulation scenario and each scheduler the cloud utilization has been printed together with the energy prices and corresponding forecasts. The results for the simulation RT Summer and the BCU\_MF scheduler are shown in Figure \ref{fig:RT_Summer_scenario_6}.

In this graph all locations are listed with each location showing a top and bottom graph. The top graph of each location shows the energy price time series over the simulation time period as a green line and the corresponding forecasts as overlay as a red line. The bottom graph shows the changes of utilization over time for each location, that is the actual total server utilization per time. 

Results show substantial variations in utilization levels over the simulation time period. The change in utilization is triggered by the actual forecasts (red line) as the BCU\_MF scheduler evaluates the utility function based on real forecasts. This can be observed when investigating the location Richmond and its utilization levels. 

The utilization at this location shows a drop in utilization levels beginning from 16th of July due to increased forecasted prices at this time. Thus the load is moved to other locations exhibiting a reduced energy price at this point in time. The same behavior can be observed for the locations Hatfield and Georgetown where utilization drops around the same time. 

In contrast the location Madison shows more stable utilization levels over time with still a trough around the same time where drops in utilization have been observed for other locations. Locations Boston and Portland have not experienced high utilization on average as the effort of moving resources to these locations is higher due to increased bandwidth (see Table \ref{tab:real_time_bandwidth_mappings}). 

However around the same time at mid of July Portland experiences a substantial increase in load which is shifted from other locations. The reason might be the small drop in energy price forecasts at Portland at 16th of July as well as a lower forecasted average price over the next hours. 

Utilization levels increase up to 50 percent at times (see location Portland) but average utilization per location goes from very low values to about 25 percent depending on the scenario. As the weights of the utility function (see Section \ref{ssec:best_utility_function}) have been set to high values for SLA penalties and cost reductions but to a low value for data center load the primary reason for VM migration are to mitigate SLA penalties due to VM downtimes and enhance cost reductions based on cheaper energy prices. Load balancing has not been considered as important metric in the presented simulations. 

The resulting graphs for all locations, all simulations and all schedulers have been placed in the Appendix for reference (\ref{sec:app_result_simulation_graphs}). The BFD scheduler in the RT summer simulation () does not consider any energy price changes in its scheduling decisions and thus load is distributed uniformly over all locations. Average utilization levels for this scheduler evolve around 8 to 10 percent. 

\begin{figure}[htbp]
	\centering
	\vspace*{-0.6in}
	\hspace*{-1.4in}
		\includegraphics[width=1.60\textwidth]{figures/evaluation_and_results/RT_Summer_scenario_6.pdf}
	\vspace*{-1.0in}
	\caption{Energy prices, energy price forecasts and utilization levels per location for simulation RT Summer and scheduler BCU\_MF}
	\label{fig:RT_Summer_scenario_6}
\end{figure}

When observing DA Summer simulation results for scheduler BCU\_MF () the relation of forecasts to actual energy prices can be seen more clearly. It seems that the forecasted energy prices ``lag behind'' the actual energy prices by a certain amount of time. Daily seasonality can be clearly spotted also in forecasted energy prices with similar patterns existing in actual energy prices. 

However for the real time price scenario shown in Figure \ref{fig:RT_Summer_scenario_6} it can be observed that the forecasts do not model the exact price time series but average out price spikes that may occur in the energy price time series. Therefore schedulers incorporating real forecasts in contrast to ideal forecasts can be seen as an advantage as they do not consider each price spike but provide a more holistic view on the energy price time series. Thus ideal forecasts may even lead to sub-optimal scheduling decisions as results showed in DA Spring and RT Spring simulations (see linked Sections \ref{ssec:simulation_scenario_da_spring} and \ref{ssec:simulation_scenario_rt_spring}). 



\subsection{Simulation results}

When comparing different scenarios the BCU\_MF scheduler of the real time simulation (RT Summer) achieves an additional cost reduction of 15\% in relation to the day ahead simulation (DA Summer) over the same time period. 
This may be attributed to the higher possibility for cost savings in the real time simulation due to a higher number of locations to migrate to. 

\begin{table}[htbp]
\centering
\begin{tabular}[\textwidth]{ll}
\toprule
	Simulation Name & Utilization  \\
\midrule
	DA Summer & 15.7 \\
	DA Spring & 14.9 \\
	RT Summer & 15.7 \\
	RT Spring & 14.9 \\
\bottomrule
\end{tabular}
\caption{Resulting cloud utilization per simulation scenario}
\label{tab:cloud_utilization_per_simulation_scenario}
\end{table}

The formula to calculate the average utilization values in Table \ref{tab:cloud_utilization_per_simulation_scenario} is defined in Equation \ref{eq:average_utilization}.
As the relation of number of VMs to number of servers has been set the same for DA and RT simulations the resulting average cloud utilization are the same for each of the Summer and Spring simulations. 

\subsection{Total costs}


\begin{table}[ht]
\centering
\begin{tabular}{lrrrrrrr}
\toprule
{} &     BFD &     BCF &   BCF\_F &  BCF\_IF &   BCU\_M &  BCU\_MF &  BCU\_MIF \\
\midrule
DA Summer &  208.36 &  181.72 &  171.85 &  174.53 &  186.19 &  \textbf{169.86} &   173.29 \\
RT Summer &  315.96 &  263.32 &  265.21 &  256.08 &  273.87 &  259.98 &   \textbf{252.09} \\
DA Spring &  930.41 &  630.13 &  592.83 &  600.42 &  625.62 &  \textbf{585.97} &   595.81 \\
RT Spring &  966.04 &  710.59 &  659.92 &  699.13 &  747.06 &  \textbf{647.57} &   668.35 \\
\bottomrule
\end{tabular}
\caption{Total costs for different scenarios (in \$)}
\end{table}

\begin{table}[ht]
\centering
\begin{tabular}{lrrrrrrr}
\toprule
{} &  BFD &    BCF &  BCF\_F &  BCF\_IF &  BCU\_M &  BCU\_MF &  BCU\_MIF \\
\midrule
DA Summer &    0 &  12.79 &  17.52 &   16.24 &  10.64 &   \textbf{18.48} &    16.83 \\
RT Summer &    0 &  16.66 &  16.06 &   18.95 &  13.32 &   17.72 &    \textbf{20.21} \\
DA Spring &    0 &  32.27 &  36.28 &   35.47 &  32.76 &   \textbf{37.02} &    35.96 \\
RT Spring &    0 &  26.44 &  31.69 &   27.63 &  22.67 &   \textbf{32.97} &    30.82 \\
\bottomrule
\end{tabular}
\caption{Normalized total cost reductions for different scenarios (in \%)}
\end{table}





